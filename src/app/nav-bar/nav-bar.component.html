<nav class="navBar py-2 px-2" aria-label="product navigation">
  <div class="navControlsContainer">
    <div class="imagePlaceholder">
      <img
        src="/assets/images/project-logo.png"
        height="40"
        class="mx-2"
        (click)="goHome()"
        style="cursor: pointer"
      />
    </div>

    <div class="searchContainer">
      <input
        type="text"
        pInputText
        placeholder="Search"
        class="ml-4 searchInput"
      />
      <button class="searchButton">
        <i class="pi pi-search"></i>
      </button>
    </div>
  </div>

  <div class="navControlsContainer accountControls">
    <a class="navBarItem" (click)="shoppingCart.toggle($event)"
      ><i
        class="pi pi-shopping-cart"
        pBadge
        severity="danger"
        [value]="getOrderItemLength().toString()"
      ></i
      ><span>Basket</span></a
    >
    <a class="navBarItem" (click)="favoriteItems.toggle($event)"
      ><i
        class="pi pi-heart"
        pBadge
        severity="danger"
        [value]="favoriteProductsList.length.toString()"
      ></i
      ><span>Favorite</span></a
    >

    <a
      class="navBarItem"
      (click)="myAccount.toggle($event)"
      *ngIf="!isAuthenticated()"
    >
      <i class="pi pi-user"></i
      ><span style="white-space: nowrap">My Account</span></a
    >
    <a
      class="navBarItem"
      (click)="userOptions.toggle($event)"
      *ngIf="isAuthenticated()"
    >
      <i class="pi pi-user"></i
      ><span *ngIf="userLoggedIn" style="white-space: nowrap">{{
        userLoggedIn.username
      }}</span></a
    >

    <div
      class="flex navBarItem"
      *ngIf="userLoggedIn && userLoggedIn.role === 'ADMIN'"
    >
      <p-button (click)="goToAdminPage()" styleClass="p-button-outlined"
        >Admin Dashboard
      </p-button>
    </div>
  </div>
</nav>

<nav class="secondaryNav">
  <p-menubar
    #nav
    [model]="navProductControls"
    class="navControls navProductControls"
  >
  </p-menubar>
</nav>

<p-overlayPanel #userOptions>
  <ng-template pTemplate="content">
    <div class="overlay">
      <p-button
        (click)="goToAccountDetailsPage()"
        label="Account Details"
        styleClass="p-button-text mt-1"
      ></p-button>
      <p-button
        (click)="gotoOrdersPage()"
        label="My Orders"
        styleClass="p-button-secondary p-button-text"
      ></p-button>
      <p-button
        (click)="logout()"
        label="Logout"
        styleClass="p-button-secondary p-button-text mb-1"
      ></p-button>
    </div>
  </ng-template>
</p-overlayPanel>
<p-overlayPanel #myAccount>
  <ng-template pTemplate="content">
    <div class="overlay">
      <p-button
        (click)="goToLoginPage()"
        label="Login"
        styleClass="p-button-secondary p-button-text"
      ></p-button>

      <p-button
        label="I don't have an account"
        styleClass="p-button-link"
        (click)="goToRegisterPage()"
      ></p-button>
      <p-button label="Forgot Password" styleClass="p-button-link"></p-button>
    </div>
  </ng-template>
</p-overlayPanel>

<p-overlayPanel #shoppingCart class="shoppingCart">
  <ng-template pTemplate="content">
    <div class="overlay">
      <p-table
        styleClass="p-datatable-sm"
        [scrollable]="true"
        [value]="orderItems"
        scrollHeight="250px"
      >
        <ng-template pTemplate="header">
          <tr class="contentRow">
            <th>Product</th>
            <th>Qty</th>
            <th>Price</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-product>
          <tr class="contentRow">
            <td class="productContainer">
              <img
                src="http://34.132.132.163:8081/api/images/download?name={{
                  product.imageName
                }}"
                alt="product photo"
              />
              <span class="productName">{{ product.productName }}</span>
            </td>

            <td>x{{ product.quantity }}</td>
            <td>${{ getItemPrice(product) }}</td>
          </tr></ng-template
        >
      </p-table>
      <p-button
        (click)="goToBasketPage()"
        label="View whole basket"
        styleClass="p-button-raised mb-1 mt-2"
      ></p-button>
    </div>
  </ng-template>
</p-overlayPanel>

<p-overlayPanel #favoriteItems class="favoriteItems">
  <ng-template pTemplate="content">
    <div class="overlay">
      <p-table
        styleClass="p-datatable-sm"
        [scrollable]="true"
        [value]="favoriteProductsList"
        scrollHeight="250px"
      >
        <ng-template pTemplate="header">
          <tr class="contentRow">
            <th>Product</th>

            <th>Price</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-product>
          <tr class="contentRow">
            <td class="productContainer">
              <img
                src="http://34.132.132.163:8081/api/images/download?name={{
                  product.imagesName[0]
                }}"
                alt="product photo"
              />
              <span class="productName">{{ product.name }}</span>
            </td>

            <td>${{ product.price }}</td>
          </tr>
        </ng-template>
      </p-table>
      <p-button
        (click)="gotToFavoritesPage()"
        label="View all"
        styleClass="p-button-raised"
      ></p-button>
    </div>
  </ng-template>
</p-overlayPanel>
